<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Watch & Earn PH</title>
<meta name="viewport" content="width=device-width">
<meta http-equiv="refresh" content=" 300; url = https://echozoneph-viewers-watchtoearn2026.netlify.app/xyzindex.html"> 
<style>
body{margin:0;font-family:Arial;background:#0b0b0b;color:#fff}
.container{max-width:900px;margin:auto;padding:20px;text-align:center}
.box{background:#111;padding:15px;border-radius:10px;margin-bottom:15px}
.green{color:#00ff88}
.lock{color:#ff6666}
button{padding:10px 15px;border:none;border-radius:6px;cursor:pointer}
button:disabled{background:#555}
input,select{padding:10px;width:100%;max-width:300px;margin:5px}
.progress{width:100%;height:12px;background:#333;border-radius:10px;overflow:hidden}
.progress div{height:100%;background:#00ff88;width:0}
.card{background:#111;padding:10px;border-radius:8px;margin-bottom:6px;text-align:left}
.hidden{display:none}
iframe{width:100%;max-width:800px;height:450px;border-radius:10px}
</style>
</head>
<body>
<div class="container">
<div class="box">
üí∞ Balance: ‚Ç±<span id="balance">0.00</span>
<div class="progress"><div id="withdrawProgress"></div></div>
<small>Minimum withdrawal ‚Ç±50</small><br>
<button id="withdrawBtn" disabled>Withdraw</button>
</div>

<h2>üé¨ Watch & Earn PH</h2>
  <h>BASIC PLAN</h>

<div id="login" class="box">
<select id="userSelect"></select>
<input id="password" type="password" placeholder="Enter password">
<button id="loginBtn">Login</button>
</div>

<div id="lockMsg" class="lock"></div>

<div id="refBox" class="box hidden">
<h3>üë• Invite Username</h3>
<input id="refUsername" placeholder="Username ng nag-invite">
<button id="saveRef">Save</button>
<div id="refMsg" class="green"></div>
</div>

<div id="playerArea"></div>
<div class="progress"><div id="videoProgress"></div></div>
<div id="timer"></div>
<div id="earned" class="green"></div>

<div class="box">
üéÅ Daily Bonus: <span id="dailyBonus" class="green"></span><br>
üé¨ Watched today: <span id="watchedCount">0</span>/6<br>
‚è≥ Next reset in: <span id="countdown"></span>
</div>

 <!-- üéØ GUESSING GAME -->
<div class="box hidden" id="guessBox">
<h3>üéØ Guessing Game</h3>
<p>Guess a number (1‚Äì50)</p>
<input type="number" id="guessInput" min="1" max="50">
<button id="guessBtn">Guess</button>
<div id="guessHint"></div>
<div id="guessTimer" class="green"></div>
</div>

<div class="box">
<h3>üìä Earnings History</h3>
<div id="earnHistory"></div>
</div>

<div class="box">
<h3>üì§ Withdrawal History</h3>
<div id="withdrawHistory"></div>
</div>

<div id="withdrawModal" class="box hidden">
<button onclick="confirmWithdraw('GCash')">GCash</button>
<button onclick="confirmWithdraw('Maya')">Maya</button>
</div>

<script>
/* USERS */
const USERS={
 user1:{pass:"dipwd1234",role:"user"},
 user2:{pass:"dipwdabcd",role:"user"},
 Johnv:{pass:"101017",role:"user"},
 Benggalleon041:{pass:"beng41",role:"user"},
 jaynegalleon:{pass:"jayne1",role:"user"},
 user3:{pass:"dipwdadmin123",role:"admin"}
};
/* VIDEOS */
const VIDEO_POOL=["tUMXTD8STeU","ZspGPko6-1w","JATpLtghZCY","vJ7iZH6ILJM","jGyG5Xty37c",
"jP96fZG48h4","evj4fzBBiFI","HRaVepQYHRA","QtBuiOSrffQ","2mEte_9nhSs","U6yvT288bY8",
"r-jw-aWkbgc","Saf0QgV2dBs","oY_yCQvZ5Ko","4bJBloATeRw","MaLbebYE83E","iIiv0j5v6t8",
"ugz6RrkaN94","QQf0Qm-o9is","lGmpCB6-LUA","X6UvWJ3ApIw","YfE4a_qwYjQ","nLmaGOOMLr8"];
const DAILY_LIMIT=6;
let currentUser=null,data=null,player=null,ytReady=false;
let timerInt,countdownInt,guessInt;

/* HELPERS */
const today=()=>new Date().toISOString().split("T")[0];
const tomorrow=()=>{let d=new Date();d.setDate(d.getDate()+1);d.setHours(0,0,0,0);return d;}
const rand=(a,b)=>+(Math.random()*(b-a)+a).toFixed(2);
const shuffle=a=>{for(let i=a.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}

/* INIT USERS */
window.onload=()=>{
 Object.keys(USERS).forEach(u=>{
  let o=document.createElement("option");
  o.value=u;o.textContent=u;
  userSelect.appendChild(o);
 });
 let last=localStorage.getItem("lastUser");
 if(last){userSelect.value=last;}
};

/* YT */
function onYouTubeIframeAPIReady(){ytReady=true}

/* LOGIN */
function doLogin(){
let last=localStorage.getItem("lastUser");
 if(last){userSelect.value=last;}
};

/* YT */
function onYouTubeIframeAPIReady(){
 ytReady=true;
 if(currentUser && data){
   loadVideo();   // siguradong maglo-load pag ready na ang YT
 }
}
/* LOGIN */
function doLogin(){
 let u=userSelect.value;
 if(!USERS[u]){alert("Select user");return;}
 if(password.value!==USERS[u].pass){alert("Wrong password");return;}

 currentUser=u;
 localStorage.setItem("lastUser",u);
 login.remove();
 refBox.classList.remove("hidden");
 guessBox.classList.remove("hidden");

 loadData();
 dailyReset();
 loadReferral();
 resumeGuess();
render();
 loadVideo();   // <-- important
}

/* EVENTS */
loginBtn.onclick=doLogin;
password.onkeypress=e=>{if(e.key==="Enter")doLogin();};

/* DATA */
function loadData(){
 data=JSON.parse(localStorage.getItem("user_"+currentUser))||{
  total:0,earn:[],withdraw:[],
  watchedToday:[],dailyVideos:[],videoIndex:0,
  lastDate:null,lastBonus:null,
  refUser:null,refReward:0,bonusVideo:null,
  secretNumber:null,guessEnd:null
 };
}
const save=()=>localStorage.setItem("user_"+currentUser,JSON.stringify(data));
/* REFERRAL */
function loadReferral(){
 if(data.refUser){
  refUsername.value=data.refUser;
  refUsername.disabled=true;
  saveRef.disabled=true;
 }
}
saveRef.onclick=()=>{
 if(data.refUser)return;
 let r=rand(0.1,8);
 data.refUser=refUsername.value;
 data.refReward=r;
 data.total+=r;
data.earn.push({type:"Invite Reward",amount:r,time:new Date().toLocaleString()});
 save();render();
 refUsername.disabled=true;saveRef.disabled=true;
 refMsg.textContent="‚Ç±"+r+" added";
};

/* DAILY RESET */
function dailyReset(){
 if(data.lastDate!==today()){
  data.lastDate=today();
  data.watchedToday=[];
  data.videoIndex=0;
  data.dailyVideos=shuffle([...VIDEO_POOL]).slice(0,DAILY_LIMIT);
  data.bonusVideo=data.dailyVideos[Math.floor(Math.random()*data.dailyVideos.length)];
 }
save();
 loadVideo();
 startCountdown();
}

/* VIDEO */
function loadVideo(){
 if(!ytReady){
   setTimeout(loadVideo,500);
   return;
 }

 if(!data.dailyVideos || data.dailyVideos.length===0){
   dailyReset();
   return;
 }
watchedCount.textContent=data.watchedToday.length;

 if(data.watchedToday.length>=DAILY_LIMIT){
  lockMsg.textContent="üîí Daily limit reached";
  playerArea.innerHTML="";
  return;
 }

 playerArea.innerHTML="<div id='player'></div>";

 player=new YT.Player("player",{
  videoId:data.dailyVideos[data.videoIndex],
  playerVars:{autoplay:1,controls:0},
  events:{
onReady:startTimer,
    onStateChange:e=>{
      if(e.data===YT.PlayerState.ENDED) reward();
    }
  }
 });
}

/* TIMER */
function startTimer(){
let chk=setInterval(()=>{
  let d=player.getDuration();
  if(d>0){clearInterval(chk);runTimer(Math.floor(d));}
 },200);
}
function runTimer(t){
 let total=t;
 clearInterval(timerInt);
 timerInt=setInterval(()=>{
  timer.textContent=`‚è± ${Math.floor(t/60)}:${String(t%60).padStart(2,"0")}`;
  videoProgress.style.width=((total-t)/total*100)+"%";
  t--; if(t<0)clearInterval(timerInt);
 },1000);
}
/* REWARD */
function reward(){
 let r=(data.dailyVideos[data.videoIndex]===data.bonusVideo)?1.99:rand(0.1,1);
 data.total+=r;
 data.watchedToday.push(data.dailyVideos[data.videoIndex]);
 data.earn.push({type:"Video",amount:r,time:new Date().toLocaleString()});
 data.videoIndex++;
 save();render();
 earned.textContent="‚Ç±"+r+" earned";
 setTimeout(loadVideo,1500);
}
/* üéØ GUESSING GAME (RESUMABLE) */
function resumeGuess(){
 if(!data.secretNumber){
  data.secretNumber=Math.floor(Math.random()*50)+1;
  data.guessEnd=Date.now()+15*60*1000;
  save();
 }
 startGuessTimer();
}
function startGuessTimer(){
 clearInterval(guessInt);
 guessInt=setInterval(()=>{
  let r=data.guessEnd-Date.now();
  if(r<=0){
   guessBtn.disabled=true;
guessTimer.textContent="‚õî Time expired";
   clearInterval(guessInt);return;
  }
  let m=Math.floor(r/60000),s=Math.floor(r%60000/1000);
  guessTimer.textContent=`‚è≥ ${m}:${String(s).padStart(2,"0")}`;
 },1000);
}
guessBtn.onclick=()=>{
 let g=Number(guessInput.value);
 if(g<1||g>50)return;
 if(g===data.secretNumber){
  let w=rand(0.1,0.5);
data.total+=w;
  data.earn.push({type:"Guess Win",amount:w,time:new Date().toLocaleString()});
  data.secretNumber=null;
  data.guessEnd=null;
  guessHint.textContent="üéâ Correct! ‚Ç±"+w;
 }else{
  data.total-=0.1;
  data.earn.push({type:"Guess Lose",amount:-0.1,time:new Date().toLocaleString()});
  guessHint.textContent=g>data.secretNumber?"‚¨á Lower":"‚¨Ü Higher";
 }
 save();render();
 if(!data.secretNumber)resumeGuess();
};
/* RENDER */
function render(){
 balance.textContent=data.total.toFixed(2);
 withdrawBtn.disabled=data.total<50;
 withdrawProgress.style.width=Math.min(data.total/50*100,100)+"%";
 earnHistory.innerHTML=data.earn.map(e=>`<div class="card">${e.type}<br>‚Ç±${e.amount}<br>${e.time}</div>`).join("");
 withdrawHistory.innerHTML=data.withdraw.map(w=>`<div class="card">${w.method} ‚Ç±${w.amount}<br>${w.time}</div>`).join("");
}
/* COUNTDOWN */
function startCountdown(){
 clearInterval(countdownInt);
 countdownInt=setInterval(()=>{
  let d=tomorrow()-new Date();
  countdown.textContent=`${Math.floor(d/3600000)}h ${Math.floor(d%3600000/60000)}m ${Math.floor(d%60000/1000)}s`;
 },1000);
}
</script>
</body>
</html>
