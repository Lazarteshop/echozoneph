<!DOCTYPE html>
<html lang="tl">
<head>
<meta charset="UTF-8">
<title>Watch & Earn PH</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="refresh" content="350; url=https://echozoneph-viewers-watchtoearn2026.netlify.app/yindex.html">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script>
const supabaseUrl = "https://latimgzxirdlcetikufy.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxhdGltZ3p4aXJkbGNldGlrdWZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzODI1NDksImV4cCI6MjA4Mzk1ODU0OX0.wfrJkLAmrn895meab65kMdsRWNapPrvWiiw8cdDCNUY";
const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);
</script>

<style>
body{margin:0;font-family:Arial;background:#0b0b0b;color:#fff}
.container{max-width:900px;margin:auto;padding:20px;text-align:center}
.box{background:#111;padding:15px;border-radius:10px;margin-bottom:15px}
.green{color:#00ff88}
.lock{color:#ff6666}
button{padding:10px 15px;border:none;border-radius:6px;cursor:pointer}
button:disabled{background:#555;cursor:not-allowed}
input,select{padding:10px;width:100%;max-width:300px;margin:5px;border-radius:6px;border:none}
.progress{width:100%;height:12px;background:#333;border-radius:10px;overflow:hidden}
.progress div{height:100%;background:#00ff88;width:0}
.card{background:#111;padding:10px;border-radius:8px;margin-bottom:6px;text-align:left}
.hidden{display:none}
iframe{width:100%;max-width:800px;height:450px;border-radius:10px}
</style>
</head>
<body>

<div class="container">

<div class="box">
ğŸ’° Balance: â‚±<span id="balance">0.00</span>
<div class="progress"><div id="withdrawProgress"></div></div>
<small>Minimum withdrawal â‚±50</small><br>
<button id="withdrawBtn" disabled>Mag-Withdraw</button>
</div>

<h2>ğŸ¬ Watch & Earn PH</h2>
<h3>BASIC PLAN</h3>

<div id="login" class="box">
<select id="userSelect"></select><br>
<input id="password" type="password" placeholder="Ilagay ang password">
</div>

<div id="lockMsg" class="lock"></div>

<div id="refBox" class="box hidden">
<h3>ğŸ‘¥ Referrer Username</h3>
<input id="refUsername" placeholder="Username ng nag-invite">
<button id="saveRef">I-save</button>
<div id="refMsg" class="green"></div>
</div>

<div id="playerArea"></div>
<div class="progress"><div id="videoProgress"></div></div>
<div id="timer"></div>
<div id="earned" class="green"></div>

<div class="box">
ğŸ Daily Bonus: <span id="dailyBonus" class="green"></span><br>
ğŸ¬ Napanood ngayon: <span id="watchedCount">0</span>/6<br>
â³ Susunod na reset sa: <span id="countdown"></span>
</div>

<div class="box">
<h3>ğŸ“Š Kasaysayan ng Kita</h3>
<div id="earnHistory"></div>
</div>

<div class="box">
<h3>ğŸ“¤ Kasaysayan ng Withdrawal</h3>
<div id="withdrawHistory"></div>
</div>

<div id="withdrawModal" class="box hidden">
<button onclick="confirmWithdraw('GCash')">GCash</button>
</div>

</div>

<!-- SCRATCH POPUP -->
<div id="scratchPopup" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:9999;align-items:center;justify-content:center;">
  <div style="background:#111;color:#fff;padding:20px;border-radius:12px;width:320px;text-align:center;">
    <h3>ğŸ§Š Account Frozen</h3>
<p>ğŸ‰ Your account is temporarily frozen, but guess what? May naghihintay na exciting scratch card for you! For only â‚±15, you can win up to â‚±30! After scratching, your account will be unfrozen. Don't miss out! #ScratchAndWin #ExcitingRewards. CLICK HEREğŸ‘‡</p>
    <div id="scratchBox"
      style="margin:15px auto;height:120px;background:#999;
      display:flex;align-items:center;justify-content:center;
      font-size:34px;font-weight:bold;color:#00ff88;cursor:pointer;border-radius:10px;">
      â‚± ?
    </div>

    <p id="scratchMsg" class="green"></p>
  </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const SCRATCH_REWARD = 0.1;
let scratchUsed=false;

const USERS={
user1:{pass:"dipwd1234",role:"user"},
Jeryanroyate:{pass:"101017",role:"user"},
risadelapate:{pass:"460613",role:"user"},
user2:{pass:"dipwdabcd",role:"user"},
John:{pass:"101017",role:"user"},
Christinebengil:{pass:"007608",role:"user"},
Jaycervantes:{pass:"101017",role:"user"},
CKill:{pass:"101017",role:"user"},
Jcarl:{pass:"101017",role:"user"},
Delf:{pass:"230738",role:"user"},
jonardbelleza:{pass:"251935",role:"user"},
Regine:{pass:"230293",role:"user"},
Benggalleon041:{pass:"beng41",role:"user"},
jaynegalleon:{pass:"jayne1",role:"user"},
user3:{pass:"dipwdadmin123",role:"admin"}
};

const VIDEO_POOL=["fjy1wYj2Nh8","tUMXTD8STeU","ZspGPko6-1w","JATpLtghZCY","vJ7iZH6ILJM","jGyG5Xty37c","jP96fZG48h4","evj4fzBBiFI","HRaVepQYHRA","QtBuiOSrffQ","2mEte_9nhSs","U6yvT288bY8","r-jw-aWkbgc","Saf0QgV2dBs","oY_yCQvZ5Ko","4bJBloATeRw","MaLbebYE83E","iIiv0j5v6t8","ugz6RrkaN94","QQf0Qm-o9is","lGmpCB6-LUA","X6UvWJ3ApIw","YfE4a_qwYjQ","nLmaGOOMLr8"];
const DAILY_LIMIT=6;

let currentUser,data,player,ytReady=false;
let dailyVideos=[],videoIndex=0;
let timerInt,countdownInt;

const today=()=>{let d=new Date();return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0")};
const tomorrow=()=>{let d=new Date();d.setDate(d.getDate()+1);d.setHours(0,0,0,0);return d};
const rand=(a,b)=>+(Math.random()*(b-a)+a).toFixed(2);
const shuffle=a=>{for(let i=a.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a};

window.onload=()=>{
 Object.keys(USERS).forEach(u=>{
  let o=document.createElement("option");
  o.value=u;o.textContent=u;
  userSelect.appendChild(o);
 });
};
function onYouTubeIframeAPIReady(){ytReady=true}

password.onkeypress = async e=>{
 if(e.key!=="Enter")return;
 let u=userSelect.value;
 if(password.value!==USERS[u].pass){alert("Mali ang password");return;}
 currentUser=u;
 login.remove();
 refBox.classList.remove("hidden");

 await loadData();
 await dailyReset();
 await claimDailyBonus();
 loadReferral();
 render();
 checkFrozenScratch();
};

async function loadData(){
 const { data:row }=await supabaseClient.from("users").select("data").eq("username",currentUser).single();
 if(!row){
  data={total:0,earn:[],withdraw:[],watchedToday:[],dailyVideos:[],lastDate:null,lastBonus:null,refUser:null,refReward:0,bonusVideo:null,accountStatus:"active"};
  await supabaseClient.from("users").insert({username:currentUser,data:data});
 }else{
  data=row.data;
  data.accountStatus=data.accountStatus||"active";
 }
}
async function save(){await supabaseClient.from("users").update({data:data}).eq("username",currentUser);}

function isFrozen(){
 if(data.accountStatus==="frozen"){
  lockMsg.textContent="ğŸ§Š Ang account mo ay naka-freeze ba din ba? Solution: Refresh you account and back to login.";
  return true;
 }
 lockMsg.textContent="";
 return false;
}

function checkFrozenScratch(){
 if(data.accountStatus==="frozen"){
  scratchPopup.style.display="flex";
 }
}

scratchBox.onclick=async()=>{
 if(scratchUsed)return;
 scratchUsed=true;

 data.total-=15;
 if(data.total<0)data.total=0;
 data.total+=SCRATCH_REWARD;
 data.accountStatus="active";

 data.earn.push({type:"Scratch Card",amount:SCRATCH_REWARD,time:new Date().toLocaleString()});

 await save();
 render();

 scratchBox.textContent="â‚±"+SCRATCH_REWARD;
 scratchMsg.textContent="âœ… Account Unfrozen!";
 setTimeout(()=>scratchPopup.style.display="none",1500);
};

function loadReferral(){
 if(data.refUser){
  refUsername.value=data.refUser;
  refUsername.disabled=true;
  saveRef.disabled=true;
 }
}
saveRef.onclick=async()=>{
 if(data.refUser)return;
 let r=rand(0.1,2);
 data.refUser=refUsername.value;
 data.refReward=r;
 data.total+=r;
 data.earn.push({type:"Invite Reward",amount:r,time:new Date().toLocaleString()});
 await save();render();
 refUsername.disabled=true;saveRef.disabled=true;
 refMsg.textContent="â‚±"+r+" nadagdag";
};

async function dailyReset(){
 if(data.lastDate!==today()){
  data.lastDate=today();
  data.watchedToday=[];
  videoIndex=0;
  dailyVideos=shuffle([...VIDEO_POOL]).slice(0,DAILY_LIMIT);
  data.dailyVideos=dailyVideos;
  data.bonusVideo=dailyVideos[Math.floor(Math.random()*dailyVideos.length)];
 }
 dailyVideos=data.dailyVideos||[];
 await save();
 if(dailyVideos.length>0){loadVideo();startCountdown();}
}

async function claimDailyBonus(){
 if(isFrozen())return;
 if(data.lastBonus===today()){dailyBonus.textContent="Claimed";return;}
 let b=rand(0.01,0.10);
 data.lastBonus=today();
 data.total+=b;
 data.earn.push({type:"Daily Bonus",amount:b,time:new Date().toLocaleString()});
 await save();
 dailyBonus.textContent="â‚±"+b;
}

function loadVideo(){
 if(isFrozen())return;
 if(!dailyVideos[videoIndex]){lockMsg.textContent="ğŸ”’ Wala pang video ngayon";return;}
 if(!ytReady){setTimeout(loadVideo,500);return;}
 watchedCount.textContent=data.watchedToday.length;
 if(data.watchedToday.length>=DAILY_LIMIT){lockMsg.textContent="ğŸ”’ Naabot na ang daily limit";return;}
 playerArea.innerHTML="<div id='player'></div>";
 player=new YT.Player("player",{videoId:dailyVideos[videoIndex],playerVars:{autoplay:1,controls:0},
 events:{onReady:startTimer,onStateChange:e=>{if(e.data===YT.PlayerState.ENDED)reward()}}});
}

function startTimer(){
 let chk=setInterval(()=>{
  let d=player.getDuration();
  if(d>0){clearInterval(chk);runTimer(Math.floor(d));}
 },200);
}
function runTimer(t){
 let total=t;
 clearInterval(timerInt);
 timerInt=setInterval(()=>{
  timer.textContent=`â± ${Math.floor(t/60)}:${String(t%60).padStart(2,"0")}`;
  videoProgress.style.width=((total-t)/total*100)+"%";
  t--; if(t<0)clearInterval(timerInt);
 },1000);
}

async function reward(){
 if(isFrozen())return;
 let r=(dailyVideos[videoIndex]===data.bonusVideo)?0.50:rand(0.1,0.30);
 data.total+=r;
 data.watchedToday.push(dailyVideos[videoIndex]);
 data.earn.push({type:"Video",amount:r,time:new Date().toLocaleString()});
 videoIndex++;
 await save();render();
 earned.textContent="â‚±"+r+" nadagdag";
 setTimeout(loadVideo,1500);
}

function render(){
 balance.textContent=data.total.toFixed(2);
 withdrawBtn.disabled=data.total<50 || data.accountStatus==="frozen";
 withdrawProgress.style.width=Math.min(data.total/50*100,100)+"%";
 earnHistory.innerHTML=data.earn.map(e=>`<div class="card">${e.type}<br>â‚±${e.amount}<br>${e.time}</div>`).join("");
 withdrawHistory.innerHTML=data.withdraw.map(w=>`<div class="card">${w.method} â‚±${w.amount}<br>${w.time}</div>`).join("");
}

withdrawBtn.onclick=()=>withdrawModal.classList.remove("hidden");
async function confirmWithdraw(m){
 if(isFrozen())return;
 data.withdraw.push({method:m,amount:data.total,time:new Date().toLocaleString()});
 data.total=0;
 await save();render();
 withdrawModal.classList.add("hidden");
}

function startCountdown(){
 clearInterval(countdownInt);
 countdownInt=setInterval(()=>{
  let d=tomorrow()-new Date();
  countdown.textContent=`${Math.floor(d/3600000)}h ${Math.floor(d%3600000/60000)}m ${Math.floor(d%60000/1000)}s`;
 },1000);
}
</script>

</body>
</html>
