<!DOCTYPE html>
<html lang="tl">
<head>
<meta charset="UTF-8">
<title>Watch & Earn PH ‚Äì Business Version</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<script>
const supabaseUrl = "https://latimgzxirdlcetikufy.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxhdGltZ3p4aXJkbGNldGlrdWZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzODI1NDksImV4cCI6MjA4Mzk1ODU0OX0.wfrJkLAmrn895meab65kMdsRWNapPrvWiiw8cdDCNUY";const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);
</script>

<style>
body{margin:0;font-family:Arial;background:#0b0b0b;color:#fff}
.container{max-width:900px;margin:auto;padding:20px;text-align:center}
.box{background:#111;padding:15px;border-radius:10px;margin-bottom:15px}
.green{color:#00ff88}
.lock{color:#ff6666}
button{padding:10px 15px;border:none;border-radius:6px;cursor:pointer}
button:disabled{background:#555;cursor:not-allowed}
input,select{padding:10px;width:100%;max-width:300px;margin:5px;border-radius:6px;border:none}
.progress{width:100%;height:12px;background:#333;border-radius:10px;overflow:hidden}
.progress div{height:100%;background:#00ff88;width:0}
.card{background:#111;padding:10px;border-radius:8px;margin-bottom:6px;text-align:left}
.hidden{display:none}
iframe{width:100%;max-width:800px;height:450px;border-radius:10px}
.vip{background:#ffd700;color:#000;font-weight:bold}
</style>
</head>
<body>
<div class="container">

<!-- BALANCE -->
<div class="box">
üí∞ Balance: ‚Ç±<span id="balance">0.00</span>
<div class="progress"><div id="withdrawProgress"></div></div>
<small>Minimum withdrawal ‚Ç±50</small><br>
<button id="withdrawBtn" disabled>Mag-Withdraw</button>
</div>

<h2>üé¨ Watch & Earn PH</h2>
<h3 id="planLabel">BASIC PLAN</h3>

<!-- LOGIN -->
<div id="login" class="box">
<select id="userSelect"></select><br>
<input id="password" type="password" placeholder="Password">
</div>

<div id="lockMsg" class="lock"></div>

<!-- VIP UPGRADE -->
<div id="vipBox" class="box hidden">
<h3>‚≠ê VIP UPGRADE</h3>
<p>‚úî Mas mataas na kita<br>‚úî Mas maraming videos<br>‚úî Walang freeze</p>
<button class="vip" onclick="requestVIP()">Upgrade to VIP (‚Ç±99)</button>
<div id="vipMsg" class="green"></div>
</div>

<!-- ADS NOTICE -->
<div id="adsBox" class="box">
üì¢ Kailangan panoorin ang ad bago makuha ang reward
<button onclick="watchAd()">Watch Ad</button>
<div id="adStatus"></div>
</div>

<!-- VIDEO AREA -->
<div id="playerArea"></div>
<div class="progress"><div id="videoProgress"></div></div>
<div id="timer"></div>
<div id="earned" class="green"></div>

<!-- DAILY INFO -->
<div class="box">
üé¨ Napanood ngayon: <span id="watchedCount">0</span>/<span id="dailyLimit">6</span><br>
‚è≥ Reset sa: <span id="countdown"></span>
</div>

<!-- HISTORY -->
<div class="box">
<h3>üìä Earnings History</h3>
<div id="earnHistory"></div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
/* USERS */
const USERS={
 Jeryanroyate:{pass:"101017",role:"user"},
 admin:{pass:"admin123",role:"admin"}
};

/* VIDEOS */
const VIDEO_POOL=["fjy1wYj2Nh8","tUMXTD8STeU","ZspGPko6-1w","JATpLtghZCY","vJ7iZH6ILJM","jGyG5Xty37c"];

let currentUser,data,player,ytReady=false;
let dailyVideos=[],videoIndex=0;
let adWatched=false;

const today=()=>new Date().toDateString();
const tomorrow=()=>{let d=new Date();d.setHours(24,0,0,0);return d};
const rand=(a,b)=>+(Math.random()*(b-a)+a).toFixed(2);

window.onload=()=>{
 Object.keys(USERS).forEach(u=>{
  let o=document.createElement("option");
  o.value=u;o.textContent=u;
  userSelect.appendChild(o);
 });
};
function onYouTubeIframeAPIReady(){ytReady=true}

password.onkeypress=async e=>{
 if(e.key!=="Enter")return;
 let u=userSelect.value;
 if(password.value!==USERS[u].pass)return alert("Mali password");
 currentUser=u;
 login.remove();
 await loadData();
 setupPlan();
 dailyReset();
 render();
};

async function loadData(){
 const {data:row}=await supabaseClient.from("users").select("data").eq("username",currentUser).single();
 if(!row){
  data={total:0,earn:[],plan:"basic",lastDate:null,watchedToday:[],adsRevenue:0};
  await supabaseClient.from("users").insert({username:currentUser,data});
 }else data=row.data;
}
async function save(){await supabaseClient.from("users").update({data}).eq("username",currentUser)}

function setupPlan(){
 if(data.plan==="vip"){
  planLabel.textContent="VIP PLAN";
  dailyLimit.textContent=12;
  vipBox.classList.add("hidden");
 }else{
  planLabel.textContent="BASIC PLAN";
  dailyLimit.textContent=6;
  vipBox.classList.remove("hidden");
 }
}

function requestVIP(){
 vipMsg.textContent="I-message ang admin pagkatapos magbayad sa GCash";
}

function watchAd(){
 adWatched=true;
 adStatus.textContent="‚úÖ Ad watched";
}

function dailyReset(){
 if(data.lastDate!==today()){
  data.lastDate=today();
  data.watchedToday=[];
  videoIndex=0;
  dailyVideos=VIDEO_POOL.slice(0,data.plan==="vip"?12:6);
 }
 loadVideo();
}

function loadVideo(){
 if(!ytReady)return setTimeout(loadVideo,500);
 if(data.watchedToday.length>=dailyVideos.length)return;
 if(!adWatched && data.plan==="basic"){
  lockMsg.textContent="üîí Kailangan muna ng ad";
  return;
 }
 lockMsg.textContent="";
 adWatched=false;
 playerArea.innerHTML="<div id='player'></div>";
 player=new YT.Player("player",{
  videoId:dailyVideos[videoIndex],
  playerVars:{autoplay:1,controls:0},
  events:{onStateChange:e=>{if(e.data===YT.PlayerState.ENDED)reward()}}
 });
}

async function reward(){
 let r=data.plan==="vip"?rand(0.3,0.8):rand(0.05,0.2);
 data.total+=r;
 data.watchedToday.push(dailyVideos[videoIndex]);
 data.earn.push({type:"Video",amount:r,time:new Date().toLocaleString()});
 videoIndex++;
 await save();
 render();
 loadVideo();
}

function render(){
 balance.textContent=data.total.toFixed(2);
 withdrawBtn.disabled=data.total<50;
 withdrawProgress.style.width=Math.min(data.total/50*100,100)+"%";
 watchedCount.textContent=data.watchedToday.length;
 earnHistory.innerHTML=data.earn.map(e=>`<div class='card'>${e.type} ‚Ç±${e.amount}<br>${e.time}</div>`).join("");
}
</script>
</div>
</body>
</html>
